<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!-- Chrome, Firefox OS and Opera Status Bar Color -->
<meta name="theme-color" content="#FFFFFF">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
<link rel="stylesheet" type="text/css"
  href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/themes/prism.min.css">
<link rel="stylesheet" type="text/css" href="css/SourceSansPro.css">
<link rel="stylesheet" type="text/css" href="css/theme.css">
<link rel="stylesheet" type="text/css" href="css/notablog.css">
<!-- Favicon -->

  <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;🐅&lt;/text&gt;&lt;/svg&gt;">

<style>
  :root {
    font-size: 20px;
  }
</style>
  <title>DICOM To FHIR ImagingStudy ⇒ Node.JS&nbsp;|&nbsp;ChinLin’s Blog</title>
  <meta property="og:type" content="blog">
  <meta property="og:title" content="DICOM To FHIR ImagingStudy ⇒ Node.JS">
  
    <meta name="description" content="DICOM 轉換 FHIR ImagingStudy 只要會對照，就可以寫出來了呢！">
    <meta property="og:description" content="DICOM 轉換 FHIR ImagingStudy 只要會對照，就可以寫出來了呢！">
  
  
    <meta property="og:image" content="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F5c33af73-a661-4dca-96dc-eebddc3fde78%2Fexchange.svg?table=block&amp;id=acf69c57-83e3-45ab-b9ce-a6fe32ce306a">
  
  <style>
    .DateTagBar {
      margin-top: 1.0rem;
    }
  </style>
</head>

<body>
  <nav class="Navbar">
  <a href="index.html">
    <div class="Navbar__Btn">
      
        <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;🐅&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
      
      <span>Home</span>
    </div>
  </a>
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="about.html">
        <div class="Navbar__Btn">
          
            <span><img class="inline-img-icon" src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F2529def0-9031-44bd-94d3-e6da4b9e887c%2F%E5%86%A0%E8%B2%93%E6%80%9D%E8%80%83.png?table=block&amp;id=721d7aeb-cf52-4f6f-9a86-648e0e7bfcb1"></span>&nbsp;
          
          <span>關於我</span>
        </div>
      </a>
    
  
</nav>
  <header class="Header">
    
    <div class="Header__Spacer Header__Spacer--NoCover">
    </div>
    
      <div class="Header__Icon">
        <span><img class="inline-img-icon" src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F5c33af73-a661-4dca-96dc-eebddc3fde78%2Fexchange.svg?table=block&amp;id=acf69c57-83e3-45ab-b9ce-a6fe32ce306a"></span>
      </div>
    
    <h1 class="Header__Title">DICOM To FHIR ImagingStudy ⇒ Node.JS</h1>
    
      <div class="DateTagBar">
        
          <span class="DateTagBar__Item DateTagBar__Date">Posted on Mon, Mar 7, 2022</span>
        
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--red">
            <a href="tag/FHIR.html">FHIR</a>
          </span>
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--gray">
            <a href="tag/DICOM.html">DICOM</a>
          </span>
        
      </div>
    
  </header>
  <article id="https://www.notion.so/acf69c5783e345abb9cea6fe32ce306a" class="PageRoot"><h1 id="https://www.notion.so/45db59dcddea49ae9c9d1ae0c35bf358" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/45db59dcddea49ae9c9d1ae0c35bf358"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">所需知識</strong></strong></span></span></h1><ul class="BulletedListWrapper"><li id="https://www.notion.so/dd4eb9f13515441ab38a2161771df563" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">FHIR Resource文件查看以及組成能力</span></span></li><li id="https://www.notion.so/fad93cc187f84d52bb275822dc53a004" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">基本的程式能力</span></span></li><li id="https://www.notion.so/10693b5f2f234d23b8d632f741c0064c" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">JSON資料格式</span></span></li></ul><h1 id="https://www.notion.so/4461564af1f4486e988e4e183511590a" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/4461564af1f4486e988e4e183511590a"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">使用工具</strong></span></span></h1><ul class="BulletedListWrapper"><li id="https://www.notion.so/87f98156850b4e59971c887e0319fcce" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://nroduit.github.io/en/getting-started/#try-weasis-now">Weasis</a></span><span class="SemanticString">或</span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://www.radiantviewer.com/download/?src=mbst&amp;f=setup">RadiAnt DICOM Viewer</a></span><span class="SemanticString"> (查看DICOM用)</span></span></li><li id="https://www.notion.so/8769f5efb9364735ae807ca859d109eb" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://code.visualstudio.com/Download">Visual Studio Code</a></span><span class="SemanticString"> (撰寫程式用)</span></span></li></ul><h1 id="https://www.notion.so/de02b30c5b7c422fa464eac747d732a6" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/de02b30c5b7c422fa464eac747d732a6"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">程式語言</strong></span></span></h1><ul class="BulletedListWrapper"><li id="https://www.notion.so/4d6275f48de74d0c9a622603526b06dc" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://nodejs.org/en/download/">Node.js</a></span></span></li></ul><h1 id="https://www.notion.so/a22ce101d88d415e87096583f5fdc635" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/a22ce101d88d415e87096583f5fdc635"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">DICOM 架構</strong></span></span></h1><div id="https://www.notion.so/0f9126485d77453d8f7d7f869d6d99d0" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">這邊使用TCIA，編號</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">0522c0001</code></span><span class="SemanticString">的部分檔案做範例，</span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://yrouka-my.sharepoint.com/:u:/g/personal/a5566qq123_my365_com_tw/Eejy-0hUEOtPoL7IJ7l-rtwB-0xUOKPOfMJRPQBi9xKXCA?e=SVzR8f">點我下載</a></span></span></p></div><div id="https://www.notion.so/43399728a8d74ae7950fdabf793220bd" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">首先快速了解DICOM檔案的架構。</span></span></p></div><div id="https://www.notion.so/07cd2b8bee644befbbd6c54bdf6af631" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">1個病人有多個Study(報告)，Study內有多個Series(部位)，Series當中有多個Instance(影像實例)。</span></span></p></div><div id="https://www.notion.so/bda49e94517f45d68a7fd02454fc92cf" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fc48258ba-5b38-41d4-8dbe-013a418c35c7%2FUntitled.png?width=502&amp;table=block&amp;id=bda49e94-517f-45d6-8a7f-d02454fc92cf"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fc48258ba-5b38-41d4-8dbe-013a418c35c7%2FUntitled.png?width=502&amp;table=block&amp;id=bda49e94-517f-45d6-8a7f-d02454fc92cf" style="width:502px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/0d92858023fa4d8c945a2ada41bd2e2d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">以JSON來看大概會長這樣</span></span></p></div><pre id="https://www.notion.so/85161cb1dcdc43e19e2c37e8085295d4" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token punctuation">{</span>
    <span class="token property">"study"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"series"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">"instance"</span><span class="token operator">:</span> <span class="token punctuation">[</span>

                <span class="token punctuation">]</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></span></span></span></code></pre><div id="https://www.notion.so/5f63d602714d4894ba23fd3228890601" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">如果太過抽象，可以透過DICOM Viewer開啟提供的範例檔。</span></span></p></div><div id="https://www.notion.so/890d14a5b8444e52a8cf87a4b3dd248f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">這裡使用Weasis開啟其中一個資料中所有的檔案。</span></span></p></div><div id="https://www.notion.so/5960053db71d41e5b8790822674a210b" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F82d5cbf0-a643-4e56-994a-016f75e1c696%2FUntitled.png?width=796&amp;table=block&amp;id=5960053d-b71d-41e5-b879-0822674a210b"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F82d5cbf0-a643-4e56-994a-016f75e1c696%2FUntitled.png?width=796&amp;table=block&amp;id=5960053d-b71d-41e5-b879-0822674a210b" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/099e8de0483b4249a1048191e45f4aca" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">藍色，以日期為標題框住的範圍為Study</span></span></li><li id="https://www.notion.so/fc252334c0444d1397baef81ff187a3f" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">綠色，單一個正方形預覽圖為Series</span></span></li><li id="https://www.notion.so/c7bce785e8964e0099fa07388eee6f9d" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">紅色，於正方形左下角之數字為此Series含有的Instance的數量</span></span></li></ul><h1 id="https://www.notion.so/4c7431ef7f5b41afabf3e9cbc49569a5" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/4c7431ef7f5b41afabf3e9cbc49569a5"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">DICOM欄位資訊</strong></span></span></h1><div id="https://www.notion.so/b40e69653a6347ff805b6d04ebd1a2b0" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">我們可以透過Weasis上的按鈕，來查看DICOM的欄位資訊，打開後請記得切換到</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">All DICOM attributes</code></span><span class="SemanticString">。</span></span></p></div><div id="https://www.notion.so/c5b323945c9142178c00e0bb4256a6b2" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F797d4e48-75f8-4275-b8a2-62f846359d48%2FUntitled.png?width=66&amp;table=block&amp;id=c5b32394-5c91-4217-8c00-e0bb4256a6b2"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F797d4e48-75f8-4275-b8a2-62f846359d48%2FUntitled.png?width=66&amp;table=block&amp;id=c5b32394-5c91-4217-8c00-e0bb4256a6b2" style="width:66px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/39ba710de3e64573be27d2a62c6c3288" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">圖中可以看到我們常用的</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">病人名稱</code></span><span class="SemanticString">欄位，由以下幾項組成:</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/f08a04540dd844d7a0a93603632ac6e4" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">(0010,0010) -&gt; 欄位標籤，解析DICOM時會用到</span></span></li></ul><blockquote id="https://www.notion.so/5cfcf87e64ba48b8865702f7284f5937" class="ColorfulBlock ColorfulBlock--ColorDefault Quote"><span class="SemanticStringArray"><span class="SemanticString">補充: DICOM PS3.6 2021e - Data Dictionary 5 ConventionsA Data Element Tag is represented as (gggg,eeee), where gggg equates to the Group Number and eeee equates to the Element Number within that Group.</span></span></blockquote><ul class="BulletedListWrapper"><li id="https://www.notion.so/c1cc8d963e494f549e7ddad9c47c1a99" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">[PN] -&gt; 欄位資料型態</span></span></li><li id="https://www.notion.so/6c791d6af29c4fff9f57419efeee3f1a" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">PatientName -&gt; 欄位名稱</span></span></li><li id="https://www.notion.so/f8cf04516f284350a8db8cf093314d47" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">0552c0001 -&gt; 數值</span></span></li></ul><div id="https://www.notion.so/c0381f0246774cdf831b7a3ad36c17bb" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fecf65837-8646-44e9-9523-6fc4b314ea47%2FUntitled.png?width=490&amp;table=block&amp;id=c0381f02-4677-4cdf-831b-7a3ad36c17bb"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fecf65837-8646-44e9-9523-6fc4b314ea47%2FUntitled.png?width=490&amp;table=block&amp;id=c0381f02-4677-4cdf-831b-7a3ad36c17bb" style="width:490px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/f474ed5985fc4769bd5314cc0d368701" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">如果想要快速查詢</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">欄位標籤</code></span><span class="SemanticString">可以使用以下網站輔助:</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/0735abe49677451fb2d75a77e24d9e44" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://www.dicomlibrary.com/dicom/dicom-tags/">DICOM Library</a></span></span></li><li id="https://www.notion.so/8fb093a8c729470da8d91ae9ea3ac0f5" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://dicom.innolitics.com/ciods">DICOM Standard Browser</a></span></span></li></ul><h2 id="https://www.notion.so/2701d2bcf9144815b655486146b0c4b9" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/2701d2bcf9144815b655486146b0c4b9"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">如何知道DICOM檔是同個Study</strong></span></span></h2><ul class="BulletedListWrapper"><li id="https://www.notion.so/2df9008e156f4272a0ac781e17e4bb4a" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">DICOM欄位有三個UID，分別是</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">StudyInstanceUID</code></span><span class="SemanticString">、</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">SeriesInstanceUID</code></span><span class="SemanticString">、</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">SOPInstanceUID (InstanceUID)</code></span><span class="SemanticString">。</span></span></li><li id="https://www.notion.so/5ee36bb24fc645aa8d7b4a363444f78f" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">只要是</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">相同</strong></span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">StudyInstanceUID</code></span><span class="SemanticString">的檔案，就代表是同個Study。</span></span></li></ul><h1 id="https://www.notion.so/be008cac3e1c4076b46034624fee4ad7" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/be008cac3e1c4076b46034624fee4ad7"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">使用程式讀取DICOM</strong></span></span></h1><div id="https://www.notion.so/fd1c1a73ed5941caaf56da34be988c87" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">此範例將示範如何取出DICOM檔案某個欄位標籤的數值。</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/4522401e3b21445c98d2c29177e2e474" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">創建資料夾</span></span></li><li id="https://www.notion.so/d60717f3e5ba44eaad71c37c0825a12d" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">用Visual Studio Code開啟資料夾</span></span></li><li id="https://www.notion.so/dcd36c5812bb409d8b1f60fa9063bb40" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">新增一個新的</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">Terminal</code></span></span></li><li id="https://www.notion.so/e2a51dafa97c403781e0f7e249262ae4" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">初始化專案</span></span></li></ul><pre id="https://www.notion.so/b24443257d07415cb0eeb6dc70b2fdc4" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token function">npm</span> init -y</span></span></span></code></pre><ul class="BulletedListWrapper"><li id="https://www.notion.so/acda3c2b40e14239a760eed315dd4796" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">安裝dicom-parser</span></span></li></ul><pre id="https://www.notion.so/65caebe3519a4343a8d7b8fcae67599c" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token function">npm</span> i dicom-parser</span></span></span></code></pre><ul class="BulletedListWrapper"><li id="https://www.notion.so/0ef76bbfef6341bcab48962012c5b340" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">開寫程式碼</span></span></li></ul><pre id="https://www.notion.so/5d81223307f444e59a13a1d4600820cc" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> dicomParser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'dicom-parser'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//讀取檔案</span>
<span class="token keyword">let</span> fileBuffer <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">"./1.3.6.1.4.1.14519.5.2.1.5099.8010.199920086920823171706454903251/1.3.6.1.4.1.14519.5.2.1.5099.8010.260151978148957514594497217760/000001.dcm"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//將讀取後的Buffer轉成Uint8Array</span>
<span class="token keyword">let</span> uint8FileBuffer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Uint8Array</span><span class="token punctuation">(</span>fileBuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//使用DICOM Parser讀取DICOM檔</span>
<span class="token keyword">let</span> dataSet <span class="token operator">=</span> dicomParser<span class="token punctuation">.</span><span class="token function">parseDicom</span><span class="token punctuation">(</span>uint8FileBuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//取出 Patient Name 0010,0010的數值</span>
<span class="token keyword">let</span> patientName <span class="token operator">=</span> dataSet<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token string">"x00100010"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//印出取得的數值</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Patient Name: "</span> <span class="token operator">+</span> patientName<span class="token punctuation">)</span><span class="token punctuation">;</span></span></span></span></code></pre><h1 id="https://www.notion.so/b833c2922452437a872d1b270fc630c6" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/b833c2922452437a872d1b270fc630c6"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">FHIR ImagingStudy</strong></span></span></h1><div id="https://www.notion.so/bd494163546f4aea8917cfa8c05597ee" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">以上大致了解了如何讀取DICOM後，現在來了解FHIR ImagingStudy。</span></span></p></div><div id="https://www.notion.so/97b322dd88a34231abe1a8cf875366e5" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">從</span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://www.hl7.org/fhir/imagingstudy.html">FHIR ImagingStudy官方文件</a></span><span class="SemanticString">以及下圖來看，ImagingStudy採用與DICOM一樣的架構來儲存資料(Study-&gt;Series-&gt;Instance)。</span></span></p></div><div id="https://www.notion.so/aab0f0f4f21b45e3a16c9e076fbadd00" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F54a3200f-3ea9-4bc1-93aa-994280cb52f8%2FUntitled.png?width=758&amp;table=block&amp;id=aab0f0f4-f21b-45e3-a16c-9e076fbadd00"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F54a3200f-3ea9-4bc1-93aa-994280cb52f8%2FUntitled.png?width=758&amp;table=block&amp;id=aab0f0f4-f21b-45e3-a16c-9e076fbadd00" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><h2 id="https://www.notion.so/3e8909a830a8448bb6e5612d8cec852d" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/3e8909a830a8448bb6e5612d8cec852d"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Mappings</strong></span></span></h2><div id="https://www.notion.so/4e4295f1e247406994420de4f746a3e0" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">官方文件也提供了DICOM轉換成FHIR ImagingStudy的Mappings，可以說是非常地友善。</span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://www.hl7.org/fhir/imagingstudy-mappings.html">ImagingStudy Mappings</a></span><span class="SemanticString">使用此表格，我們就可以輕易地將DICOM轉成FHIR的格式。</span></span></p></div><div id="https://www.notion.so/7a984d510e234acd8718d073aa388570" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F3e215d85-d2f1-4352-9dd7-6898c9daf4e8%2FUntitled.png?width=1526&amp;table=block&amp;id=7a984d51-0e23-4acd-8718-d073aa388570"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F3e215d85-d2f1-4352-9dd7-6898c9daf4e8%2FUntitled.png?width=1526&amp;table=block&amp;id=7a984d51-0e23-4acd-8718-d073aa388570" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><h1 id="https://www.notion.so/9f5427f4077f43809b9636273f1ab365" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/9f5427f4077f43809b9636273f1ab365"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">DICOM轉成ImagingStudy</strong></span></span></h1><h2 id="https://www.notion.so/03712866fe8e49f196d9c917ae1d7f54" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/03712866fe8e49f196d9c917ae1d7f54"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">撰寫Data Types的Class</strong></span></span></h2><div id="https://www.notion.so/91412c414e7a4a7a8a3487e54e2aef47" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">為方便使用及管理程式碼，首先要做的是幫 ImagingStudy 使用到的 Data Types 寫成 Class 以利組成 ImagingStudy。</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/f451eeaa1fe9463faf9719f44a517338" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">創建</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">FHIRDataTypes.js</code></span><span class="SemanticString">檔案並把 Class 都寫在此檔案</span></span></li><li id="https://www.notion.so/55dc5813aa2c48fa88f9c2d7ca72fce0" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">以</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">Identifier</code></span><span class="SemanticString"> type為例</span></span></li></ul><div id="https://www.notion.so/9961c13452cb40a8acb7a826a2189331" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F131ab798-2943-4218-8d8a-87d97c6f8937%2FUntitled.png?width=1132&amp;table=block&amp;id=9961c134-52cb-40a8-acb7-a826a2189331"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F131ab798-2943-4218-8d8a-87d97c6f8937%2FUntitled.png?width=1132&amp;table=block&amp;id=9961c134-52cb-40a8-acb7-a826a2189331" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/8b926d84fc374b3e84023168d525afb1" class="ColorfulBlock ColorfulBlock--BgYellow Callout"><div class="Callout__Icon"><div class="Icon">⚠️</div></div><p class="Callout__Content"><span class="SemanticStringArray"><span class="SemanticString">注意 Identifier 底下還包含了幾種需要建成 Class 的 Type:
- CodeableConcept
- Period
- Reference</span></span></p></div><pre id="https://www.notion.so/d2c314f54eb14ceca61bbb2c7316c8f3" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token comment">//Coding</span>
<span class="token keyword">class</span> <span class="token class-name">Coding</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>system <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>version <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>code <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>userSelected <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//CodeableConcept</span>
<span class="token keyword">class</span> <span class="token class-name">CodeableConcept</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>Coding <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//Period</span>
<span class="token keyword">class</span> <span class="token class-name">Period</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>start <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>end <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//Reference</span>
<span class="token keyword">class</span> <span class="token class-name">Reference</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>reference <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span> <span class="token comment">//(Literal reference, Relative, internal or absolute URL)(string)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span> <span class="token comment">//string</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>identifier <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//Identifier</span>
<span class="token keyword">class</span> <span class="token class-name">Identifier</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>use <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CodeableConcept</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>system <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>period <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Period</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></span></span></span></code></pre><div id="https://www.notion.so/4d50abb871fe46aaae6b093ec693af0b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">最後在一步一步把 ImagingStudy 的 Class 都寫完。</span></span></p></div><div id="https://www.notion.so/adadb369a0e84724a02d5143cc7d0cf8" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">完整的FHIR Data Types Class:</span></span></p></div><div id="https://www.notion.so/0602d2324bc240089ba9561971d1c936" class="ColorfulBlock ColorfulBlock--BgBlue Callout"><div class="Callout__Icon"><img class="Icon" style="width:1.5em;height:1.5em" src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fcba4c281-206b-46ba-80d6-cec7c5f10fe7%2Fmark-github.svg?table=block&amp;id=0602d232-4bc2-4008-9ba9-561971d1c936"/></div><p class="Callout__Content"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://github.com/chinlin-example/dicom-to-fhir/blob/62df074ccc7bfe1702d0069ffebc4d6393dad744/nodejs/src/FHIRDataTypes.js">Github 點我看程式碼</a></span></span></p></div><h1 id="https://www.notion.so/54e19b5af84948aa92a6253486c29764" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/54e19b5af84948aa92a6253486c29764"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">轉換主程式</strong></span></span></h1><div id="https://www.notion.so/d494eb698eb148648f8f8a56fa668c37" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">上面已經把會用到的Data Types轉成 Class了，現在開始撰寫轉換的程式。</span><span class="SemanticString">思路如下</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/4fb1693f2f164d0e90e321b44930f88a" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">讀取 DICOM 檔案</span></span></li><li id="https://www.notion.so/c9814b7a90ad455caa04253c19c40f92" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">搭配</span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://www.hl7.org/fhir/imagingstudy-mappings.html">ImagingStudy Mappings</a></span><span class="SemanticString">對照 DICOM Tags 轉換到FHIR的欄位</span></span></li><li id="https://www.notion.so/7d2dba671ef245369e6b80ccb32db21e" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">使用dicom-parser讀取數值</span></span></li><li id="https://www.notion.so/e0a683f3356349b0bd62dc87b9595223" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">利用剛剛寫的 Class 把數值填入對應的 Class</span></span></li><li id="https://www.notion.so/48c015a01ac54e8cb372d4f15325e1c0" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">把 ImagingStudy 組合起來</span></span></li></ul><h2 id="https://www.notion.so/2742f7c5b684411ebf4a6f1fe8e352f3" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/2742f7c5b684411ebf4a6f1fe8e352f3"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">套件</strong></span></span></h2><ul class="BulletedListWrapper"><li id="https://www.notion.so/e39454bea952429a8a0852e195202ed0" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">dicom-parser (解析dicom用)</span></span></li><li id="https://www.notion.so/b052c5f91c204b91aaf727eb889598de" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">flat</span></span></li><li id="https://www.notion.so/f2fb7c03ae344b26aa112b863b93c34e" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">lodash</span></span></li><li id="https://www.notion.so/28a8ed7fe23943788d5ea3dcd0b3bf31" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">moment</span></span></li></ul><pre id="https://www.notion.so/584403e013714de4b170646f91219677" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token function">npm</span> <span class="token function">install</span> dicom-parser flat lodash moment</span></span></span></code></pre><h1 id="https://www.notion.so/2016f69cc0df4301bce35472ba794d48" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/2016f69cc0df4301bce35472ba794d48"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">整體專案完整程式碼</span></span></h1><div id="https://www.notion.so/bc22c65519d543d7a84bc3ae5308ce74" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">到專案主頁面會有 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">C#</code></span><span class="SemanticString"> 、</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">Python</code></span><span class="SemanticString"> 版本的範例，以下為 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">node.js</code></span><span class="SemanticString"> 範例</span></span></p></div><div id="https://www.notion.so/84d2470acf15405b8d518dd0b1f726fd" class="ColorfulBlock ColorfulBlock--BgBlue Callout"><div class="Callout__Icon"><img class="Icon" style="width:1.5em;height:1.5em" src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fd3acce22-973d-450d-9d96-1609bd6e318a%2Fmark-github.svg?table=block&amp;id=84d2470a-cf15-405b-8d51-8dd0b1f726fd"/></div><p class="Callout__Content"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://github.com/chinlin-example/dicom-to-fhir/blob/62df074ccc7bfe1702d0069ffebc4d6393dad744/nodejs/src/DICOM2FHIRImagingStudy.js">Github 點我看程式碼</a></span></span></p></div><h1 id="https://www.notion.so/268dbcd25c024343b350cb1c34964e61" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/268dbcd25c024343b350cb1c34964e61"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">單檔案程式碼</span></span></h1><div id="https://www.notion.so/5862da5628c344ffa261fa6ef698f23a" class="ColorfulBlock ColorfulBlock--BgGreen Callout"><div class="Callout__Icon"><div class="Icon">👀</div></div><p class="Callout__Content"><span class="SemanticStringArray"><span class="SemanticString">如果覺得上面的專案比較複雜，可以看看這支程式碼都寫在一個檔案的範例</span></span></p></div><div id="https://www.notion.so/9b2f4593571d4b62b33b2c525b79666a" class="ColorfulBlock ColorfulBlock--BgBlue Callout"><div class="Callout__Icon"><img class="Icon" style="width:1.5em;height:1.5em" src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fa3e554e9-3324-4db2-80ff-772e70599ea0%2Fmark-github.svg?table=block&amp;id=9b2f4593-571d-4b62-b33b-2c525b79666a"/></div><p class="Callout__Content"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://github.com/chinlin-example/node-dicom-to-fhir-example">Github 點我看程式碼</a></span></span></p></div><h1 id="https://www.notion.so/8d06742552d84b08b99aa7845d3cba61" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/8d06742552d84b08b99aa7845d3cba61"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">轉換結果</strong></strong></span></span></h1><pre id="https://www.notion.so/90f4a03cf4d04a579129fec90bea921f" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token punctuation">{</span>
    <span class="token string-property property">"resourceType"</span><span class="token operator">:</span> <span class="token string">"ImagingStudy"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"id"</span><span class="token operator">:</span> <span class="token string">"1.2.826.0.1.3680043.8.1055.1.20111102150758591.92402465.76095170"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"identifier"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token string-property property">"use"</span><span class="token operator">:</span> <span class="token string">"official"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"system"</span><span class="token operator">:</span> <span class="token string">"urn:dicom:uid"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"value"</span><span class="token operator">:</span> <span class="token string">"urn:oid:1.2.826.0.1.3680043.8.1055.1.20111102150758591.92402465.76095170"</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string-property property">"status"</span><span class="token operator">:</span> <span class="token string">"unknown"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"subject"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">"reference"</span><span class="token operator">:</span> <span class="token string">"Patient/0"</span><span class="token punctuation">,</span>
        <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"Patient"</span><span class="token punctuation">,</span>
        <span class="token string-property property">"identifier"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string-property property">"use"</span><span class="token operator">:</span> <span class="token string">"usual"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"value"</span><span class="token operator">:</span> <span class="token string">"0"</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string-property property">"started"</span><span class="token operator">:</span> <span class="token string">"2006-10-12T01:02:58.000Z"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"description"</span><span class="token operator">:</span> <span class="token string">"CT1 abdomen"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"series"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token string-property property">"uid"</span><span class="token operator">:</span> <span class="token string">"1.2.826.0.1.3680043.8.1055.1.20111102150758591.96842950.07877442"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"number"</span><span class="token operator">:</span> <span class="token number">6168</span><span class="token punctuation">,</span>
            <span class="token string-property property">"modality"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token string-property property">"system"</span><span class="token operator">:</span> <span class="token string">"http://dicom.nema.org/resources/ontology/DCM"</span><span class="token punctuation">,</span>
                <span class="token string-property property">"code"</span><span class="token operator">:</span> <span class="token string">"CT"</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token string-property property">"description"</span><span class="token operator">:</span> <span class="token string">"ARTERIELLE"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"instance"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token punctuation">{</span>
                    <span class="token string-property property">"uid"</span><span class="token operator">:</span> <span class="token string">"1.2.826.0.1.3680043.8.1055.1.20111102150758591.03296050.69180943"</span><span class="token punctuation">,</span>
                    <span class="token string-property property">"sopClass"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                        <span class="token string-property property">"system"</span><span class="token operator">:</span> <span class="token string">"urn:ietf:rfc:3986"</span><span class="token punctuation">,</span>
                        <span class="token string-property property">"code"</span><span class="token operator">:</span> <span class="token string">"urn:oid:1.2.840.10008.5.1.4.1.1.2"</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token string-property property">"number"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                    <span class="token string-property property">"title"</span><span class="token operator">:</span> <span class="token string">"ORIGINAL\\PRIMARY\\AXIAL\\HELIX"</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span></span></span></span></code></pre></article>
<br />
<script src="https://utteranc.es/client.js"
  repo="Chinlinlee/Chinlinlee.github.io"
  issue-term="pathname"
  theme="github-light"
  crossorigin="anonymous"
  async>
</script>
  <footer class="Footer">
  <div>&copy; ChinLin’s Blog 2021-2022</div>
  <div>&centerdot;</div>
  <div>Powered by <a href="https://github.com/dragonman225/notablog" target="_blank"
      rel="noopener noreferrer">Notablog</a>.
  </div>
</footer>
</body>

</html>
<script src="./scripts/code-copy.js"></script>